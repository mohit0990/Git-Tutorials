code of initial index version3