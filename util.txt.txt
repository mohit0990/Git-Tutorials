code of initial util version 3